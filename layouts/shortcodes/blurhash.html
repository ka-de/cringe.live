{{- $width := .Get "width" | default "400" -}}
{{- $height := .Get "height" | default "300" -}}
{{- $alt := .Get "alt" | default "" -}}
{{- $src := .Get "src" -}}
{{- $blurhash := .Get "blurhash" -}}
{{- $grid := .Get "grid" | default "false" -}}

{{ if eq $grid "true" }}
<div class="image-grid-container">
{{ end }}

<div class="image-container" data-width="{{ $width }}" data-height="{{ $height }}">
    <canvas 
        class="blur-hash" 
        data-blurhash="{{ $blurhash }}" 
        width="{{ $width }}" 
        height="{{ $height }}"
    ></canvas>
    <img 
        src="{{ $src }}" 
        loading="lazy" 
        width="{{ $width }}" 
        height="{{ $height }}"
        alt="{{ $alt }}"
        onload="this.previousElementSibling.style.display = 'none'; this.style.opacity = 1;"
        onerror="this.previousElementSibling.style.filter = 'brightness(0.8) contrast(1.2)';"
    >
</div>

{{ if eq $grid "true" }}
</div>
{{ end }}
